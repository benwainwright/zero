import{p as o,a as q,w as pe,y as ue}from"./chunk-7TW6LJC6-DaDHYynL.js";import{q as F,i as C,l as B,B as R,m as A,h as L,w as me,x as H,I as K,u as he,k as V,y as fe,z as ye}from"./current-user-provider-CQskWHqO.js";import{u as ge}from"./use-data-Qeg4wdiC.js";import{c as xe,b as ve,u as je,T as Ce}from"./use-form-CHjNTqrC.js";import{P as Se}from"./page-9TQxibTZ.js";import{a as be,F as W,S as Re}from"./Stack-DWOd-5q9.js";import{d as we,g as Q,a as x,b,c as Ne}from"./use-isomorphic-effect-BxLUwthI.js";import{c as Pe}from"./create-safe-context-BWzhtqVO.js";import{p as J}from"./px-DP8G9a6Q.js";import{a as _e}from"./get-sorted-breakpoints-BcBmEGf0.js";import{T as v}from"./Text-BCB6W5jQ.js";import{u as X,G as Ge}from"./Group-CX22UYal.js";import"./use-command-DCyiuDTW.js";import"./use-events-BzQNw1ET.js";import"./CloseButton-BtMh9jHH.js";import"./UnstyledButton-AqrG-hBD.js";import"./route-available-D-XKoVLa.js";function j(e){return typeof e=="object"&&e!==null?"base"in e?e.base:void 0:e}var Y={root:"m_1b7284a3"};const Ve=A((e,{radius:s,shadow:t})=>({root:{"--paper-radius":s===void 0?void 0:Q(s),"--paper-shadow":we(t)}})),E=F((e,s)=>{const t=C("Paper",null,e),{classNames:d,className:n,style:i,styles:c,unstyled:a,withBorder:u,vars:l,radius:r,shadow:p,variant:h,mod:f,attributes:y,...g}=t,m=B({name:"Paper",props:t,classes:Y,className:n,style:i,classNames:d,styles:c,unstyled:a,attributes:y,vars:l,varsResolver:Ve});return o.jsx(R,{ref:s,mod:[{"data-with-border":u},f],...m("root"),variant:h,...g})});E.classes=Y;E.displayName="@mantine/core/Paper";const[Be,$e]=Pe("Card component was not found in tree");var U={root:"m_e615b15f",section:"m_599a2148"};const $=F((e,s)=>{const t=C("CardSection",null,e),{classNames:d,className:n,style:i,styles:c,vars:a,withBorder:u,inheritPadding:l,mod:r,...p}=t,h=$e();return o.jsx(R,{ref:s,mod:[{"with-border":u,"inherit-padding":l},r],...h.getStyles("section",{className:n,style:i,styles:c,classNames:d}),...p})});$.classes=U;$.displayName="@mantine/core/CardSection";const ke=A((e,{padding:s})=>({root:{"--card-padding":x(s)}})),w=F((e,s)=>{const t=C("Card",null,e),{classNames:d,className:n,style:i,styles:c,unstyled:a,vars:u,children:l,padding:r,attributes:p,...h}=t,f=B({name:"Card",props:t,classes:U,className:n,style:i,classNames:d,styles:c,unstyled:a,attributes:p,vars:u,varsResolver:ke}),y=q.Children.toArray(l),g=y.map((m,N)=>typeof m=="object"&&m&&"type"in m&&m.type===$?q.cloneElement(m,{"data-first-section":N===0||void 0,"data-last-section":N===y.length-1||void 0}):m);return o.jsx(Be,{value:{getStyles:f},children:o.jsx(E,{ref:s,unstyled:a,...f("root"),...h,children:g})})});w.classes=U;w.displayName="@mantine/core/Card";w.Section=$;const[Ie,Te]=xe();function Z(e){const{value:s,defaultValue:t,onChange:d,multiple:n,children:i}=C("ChipGroup",null,e),[c,a]=X({value:s,defaultValue:t,finalValue:n?[]:null,onChange:d}),u=r=>Array.isArray(c)?c.includes(r):r===c,l=r=>{const p=r.currentTarget.value;Array.isArray(c)?a(c.includes(p)?c.filter(h=>h!==p):[...c,p]):a(p)};return o.jsx(Ie,{value:{isChipSelected:u,onChange:l,multiple:n},children:i})}Z.displayName="@mantine/core/ChipGroup";var ee={root:"m_f59ffda3",label:"m_be049a53","label--outline":"m_3904c1af","label--filled":"m_fa109255","label--light":"m_f7e165c3",iconWrapper:"m_9ac86df9",checkIcon:"m_d6d72580",input:"m_bde07329"};const qe={type:"checkbox"},Fe=A((e,{size:s,radius:t,variant:d,color:n,autoContrast:i})=>{const c=e.variantColorResolver({color:n||e.primaryColor,theme:e,variant:d||"filled",autoContrast:i});return{root:{"--chip-fz":Ne(s),"--chip-size":b(s,"chip-size"),"--chip-radius":t===void 0?void 0:Q(t),"--chip-checked-padding":b(s,"chip-checked-padding"),"--chip-padding":b(s,"chip-padding"),"--chip-icon-size":b(s,"chip-icon-size"),"--chip-bg":n||d?c.background:void 0,"--chip-hover":n||d?c.hover:void 0,"--chip-color":n||d?c.color:void 0,"--chip-bd":n||d?c.border:void 0,"--chip-spacing":b(s,"chip-spacing")}}}),k=L((e,s)=>{const t=C("Chip",qe,e),{classNames:d,className:n,style:i,styles:c,unstyled:a,vars:u,id:l,checked:r,defaultChecked:p,onChange:h,value:f,wrapperProps:y,type:g,disabled:m,children:N,size:te,variant:O,icon:P,rootRef:oe,autoContrast:We,mod:re,attributes:ae,...ne}=t,S=B({name:"Chip",classes:ee,props:t,className:n,style:i,classNames:d,styles:c,unstyled:a,attributes:ae,vars:u,varsResolver:Fe}),_=Te(),D=ve(l),{styleProps:ie,rest:ce}=me(ne),[le,de]=X({value:r,defaultValue:p,finalValue:!1,onChange:h}),M=_?{checked:_.isChipSelected(f),onChange:G=>{_.onChange(G),h?.(G.currentTarget.checked)},type:_.multiple?"checkbox":"radio"}:{},I=M.checked||le;return o.jsxs(R,{size:te,variant:O,ref:oe,mod:re,...S("root"),...ie,...y,children:[o.jsx("input",{type:g,...S("input"),checked:I,onChange:G=>de(G.currentTarget.checked),id:D,disabled:m,ref:s,value:f,...M,...ce}),o.jsxs("label",{htmlFor:D,"data-checked":I||void 0,"data-disabled":m||void 0,...S("label",{variant:O||"filled"}),children:[I&&P!==null&&P!==!1&&o.jsx("span",{...S("iconWrapper"),children:P===void 0?o.jsx(be,{...S("checkIcon")}):P}),o.jsx("span",{children:N})]})]})});k.classes=ee;k.displayName="@mantine/core/Chip";k.Group=Z;function Ae({spacing:e,verticalSpacing:s,cols:t,selector:d}){const n=he(),i=s===void 0?e:s,c=H({"--sg-spacing-x":x(j(e)),"--sg-spacing-y":x(j(i)),"--sg-cols":j(t)?.toString()}),a=V(n.breakpoints).reduce((r,p)=>(r[p]||(r[p]={}),typeof e=="object"&&e[p]!==void 0&&(r[p]["--sg-spacing-x"]=x(e[p])),typeof i=="object"&&i[p]!==void 0&&(r[p]["--sg-spacing-y"]=x(i[p])),typeof t=="object"&&t[p]!==void 0&&(r[p]["--sg-cols"]=t[p]),r),{}),l=_e(V(a),n.breakpoints).filter(r=>V(a[r.value]).length>0).map(r=>({query:`(min-width: ${n.breakpoints[r.value]})`,styles:a[r.value]}));return o.jsx(K,{styles:c,media:l,selector:d})}function T(e){return typeof e=="object"&&e!==null?V(e):[]}function Ee(e){return e.sort((s,t)=>J(s)-J(t))}function Ue({spacing:e,verticalSpacing:s,cols:t}){const d=Array.from(new Set([...T(e),...T(s),...T(t)]));return Ee(d)}function ze({spacing:e,verticalSpacing:s,cols:t,selector:d}){const n=s===void 0?e:s,i=H({"--sg-spacing-x":x(j(e)),"--sg-spacing-y":x(j(n)),"--sg-cols":j(t)?.toString()}),c=Ue({spacing:e,verticalSpacing:s,cols:t}),a=c.reduce((l,r)=>(l[r]||(l[r]={}),typeof e=="object"&&e[r]!==void 0&&(l[r]["--sg-spacing-x"]=x(e[r])),typeof n=="object"&&n[r]!==void 0&&(l[r]["--sg-spacing-y"]=x(n[r])),typeof t=="object"&&t[r]!==void 0&&(l[r]["--sg-cols"]=t[r]),l),{}),u=c.map(l=>({query:`simple-grid (min-width: ${l})`,styles:a[l]}));return o.jsx(K,{styles:i,container:u,selector:d})}var se={container:"m_925c2d2c",root:"m_2415a157"};const Oe={cols:1,spacing:"md",type:"media"},z=L((e,s)=>{const t=C("SimpleGrid",Oe,e),{classNames:d,className:n,style:i,styles:c,unstyled:a,vars:u,cols:l,verticalSpacing:r,spacing:p,type:h,attributes:f,...y}=t,g=B({name:"SimpleGrid",classes:se,props:t,className:n,style:i,classNames:d,styles:c,unstyled:a,attributes:f,vars:u}),m=fe();return h==="container"?o.jsxs(o.Fragment,{children:[o.jsx(ze,{...t,selector:`.${m}`}),o.jsx("div",{...g("container"),children:o.jsx(R,{ref:s,...g("root",{className:m}),...y})})]}):o.jsxs(o.Fragment,{children:[o.jsx(Ae,{...t,selector:`.${m}`}),o.jsx(R,{ref:s,...g("root",{className:m}),...y})]})});z.classes=se;z.displayName="@mantine/core/SimpleGrid";const De=e=>{const{data:s,isPending:t,update:d,save:n}=ge({query:"GetRole",command:"UpdateRoleCommand",mapToLocalData:i=>i?.toObject(),refreshOn:["RoleUpdated"]},{id:e});return{role:s,isPending:t,updateRole:d,saveRole:n}},Me=()=>{const{roleId:e}=ue();if(!e)throw new Error("User id missing!");const{role:s,updateRole:t,isPending:d,saveRole:n}=De(e),i=je({onValuesChange:a=>{t(a)}});q.useEffect(()=>{!d&&s&&(i.setValues(s),i.resetDirty())},[d]);const c=async()=>{await n()};return o.jsx(Se,{routeName:"editRole",title:"Edit Role",children:o.jsxs("form",{method:"post",onSubmit:i.onSubmit(c),children:[o.jsx(Ce,{label:"Name",placeholder:"",...i.getInputProps("name")},i.key("name")),o.jsx(W,{legend:"Permissions",mt:"lg",children:o.jsx(Re,{children:s?.permissions.map(a=>o.jsx(w,{withBorder:!0,radius:"md",padding:"md",shadow:"sm",children:o.jsx(w.Section,{children:o.jsxs(z,{cols:2,p:"sm",style:{justifyItems:"center"},children:[o.jsx(v,{fw:500,children:"Action"}),o.jsx(v,{children:a.action}),o.jsx(v,{fw:500,children:"Capabilities"}),o.jsx(v,{children:a.capabilities.join(", ")}),o.jsx(v,{fw:500,children:"Resource"}),o.jsx(v,{children:typeof a.resource=="string"?a.resource:a.resource.id})]})})},`role-perm-${JSON.stringify(a)}`))})}),o.jsx(W,{mt:"md",legend:"Visible Routes",pt:"md",children:o.jsx(Ge,{children:ye.map(a=>o.jsx(k,{checked:i.values.routes?.includes(a),onChange:u=>{i.setValues(l=>u&&!l.routes?.includes(a)?{...l,routes:[...l.routes??[],a]}:u?l:{...l,routes:l.routes?.filter(r=>r!==a)??[]})},children:a}))})})]})})},ls=pe(Me);export{ls as default};
