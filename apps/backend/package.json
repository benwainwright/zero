{
  "name": "@zero/backend",
  "version": "0.0.1",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "vite-node src/start.ts"
  },
  "main": "./src/index.ts",
  "types": "./src/index.ts",
  "exports": {
    ".": {
      "types": "./src/index.ts",
      "import": "./src/index.ts",
      "default": "./src/index.ts"
    },
    "./package.json": "./package.json"
  },
  "dependencies": {
    "@drizzle-team/brocli": "0.11.0",
    "@inversifyjs/strongly-typed": "catalog:",
    "@zero/accounts": "workspace:*",
    "@zero/application-core": "workspace:*",
    "@zero/auth": "workspace:*",
    "@zero/bootstrap": "workspace:*",
    "@zero/domain": "workspace:*",
    "@zero/integration-adapters": "workspace:*",
    "@zero/kysely-shared": "workspace:*",
    "@zero/node-adapters": "workspace:*",
    "@zero/postgres-adapters": "workspace:*",
    "@zero/sqlite-adapters": "workspace:*",
    "@zero/websocket-adapter": "workspace:*",
    "aws-cdk": "2.1100.1",
    "aws-cdk-lib": "^2.236.0",
    "constructs": "^10.4.5"
  },
  "devDependencies": {
    "vite-node": "5.2.0",
    "vite-plugin-node-polyfills": "0.24.0",
    "vite-plugin-static-copy": "3.1.4"
  },
  "nx": {
    "targets": {
      "build": {
        "executor": "nx:run-commands",
        "options": {
          "env": {
            "DATABASE": "postgres",
            "STORAGE": "s3"
          }
        }
      },
      "docker:publish": {
        "executor": "nx:run-commands",
        "dependsOn": [
          "docker:build"
        ],
        "options": {
          "cwd": "apps/backend",
          "commands": [
            "docker push benwainwrightmanch/zero --all-tags"
          ]
        }
      },
      "docker:build": {
        "dependsOn": [
          "build"
        ],
        "options": {
          "cwd": "apps/backend",
          "args": [
            "--tag benwainwrightmanch/zero:latest --tag benwainwrightmanch/zero:$(git rev-parse HEAD)"
          ]
        }
      },
      "deploy": {
        "executor": "nx:run-commands",
        "options": {
          "command": "railway up --service \"@zero/backend\" --verbose --ci"
        }
      },
      "start:database": {
        "continuous": true,
        "executor": "nx:run-commands",
        "options": {
          "command": "docker-compose up",
          "cwd": "apps/backend"
        }
      },
      "dev": {
        "continuous": true,
        "executor": "nx:run-commands",
        "options": {
          "cwd": "apps/backend",
          "commands": [
            "vite-node  src/cli.ts start"
          ],
          "env": {
            "DATABASE": "postgres",
            "STORAGE": "flatfile"
          }
        },
        "configurations": {
          "postgres": {
            "env": {
              "DATABASE": "postgres",
              "ZERO_CONFIG_POSTGRES_PORT": "5432"
            }
          },
          "sqlite": {
            "env": {
              "DATABASE": "sqlite"
            }
          }
        }
      }
    }
  }
}
